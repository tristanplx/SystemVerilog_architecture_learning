#!/bin/bash

export PROJECTNAME="."

# Remove existing librairies

vdel -lib LIB_RTL -all
vdel -lib LIB_BENCH -all

# Build librairies
vlib LIB/LIB_RTL
vmap LIB_RTL LIB/LIB_RTL
vlib LIB/LIB_BENCH
vmap LIB_BENCH LIB/LIB_BENCH

# Define compilation options
VLOG_OPTS="-sv +acc -svinputport=net"

# Compilation des fichiers RTL
vlog $VLOG_OPTS -work LIB_RTL ./SRC/RTL/instructionMemory.sv
vlog $VLOG_OPTS -work LIB_RTL ./SRC/RTL/mux.sv

# Compilation des BENCH
vlog $VLOG_OPTS -work LIB_BENCH -L LIB_RTL SRC/BENCH/instructionMemory_tb.sv
vlog $VLOG_OPTS -work LIB_BENCH -L LIB_RTL SRC/BENCH/mux_tb.sv

# Simulation
# Décommenter une seule ligne qui sera la ligne simulée
#vsim -L LIB_RTL LIB_BENCH.instructionMemory_tb
vsim -L LIB_RTL LIB_BENCH.mux_tb